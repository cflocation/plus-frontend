<?phpfunction createAssets(&$objPHPPowerPoint, $arrUser, $theseassets, $arrNetworks){	$currentSlide = createTemplatedSlide($objPHPPowerPoint, $arrUser, '0'); // local function	if($arrUser['corporationId'] != 15){		$background = '/ini.png';	}	else{		$background = '/bkground.jpg';	}    $currentSlide->createDrawingShape()          ->setName('Background')          ->setDescription('Background')          ->setPath(getcwd().'/ppt/corps/'.$arrUser["corporationId"].$background)          ->setWidth(955)          ->setHeight(720)          ->setOffsetX(0)          ->setOffsetY(0);          	$corp_ids = array(4,5,14,15,18,19,20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,42,43,44,45,46,47,48,49);	if(! in_array($arrUser["corporationId"], $corp_ids)){			$shape = $currentSlide->createRichTextShape();		$shape->setHeight(50);		$shape->setWidth(950);		$shape->setOffsetX(5);		$shape->setOffsetY(90);	}		$assets		= $theseassets;						$imgnum 	= count($assets);		$imagesize 	= ceil($imgnum/4);						if($imgnum > 4 && $imgnum < 17){			$numCols = 4;			$div_x	= 600/4;			$comp 	= 175;					}		elseif($imgnum > 16 && $imgnum < 29){			$numCols = ceil($imgnum/4);						$div_x	= 800/$numCols;			$comp 	= 75;		}		else{			$numCols = $imgnum;					$div_x	= 950/$numCols;			$comp 	= 5;		}		//calculating and adjusting number of rows		$numRows 	= ceil($imgnum / 4);			if($numRows > 4){			$numRows = 4;		}				$verticalspace = 45;		if($numRows == 2){			$verticalspace = 55;		}						//setting up image sizes (height and width)		if($numRows == 1){			$imgH		= 360;					$imgW		= 240;			$logosize	= 50;		}			elseif($numRows == 2){			$imgH		= 222;					$imgW		= 148;			$logosize=  35;			}		elseif($numRows == 3){			$imgH		= 137;					$imgW		= 91;					$logosize	= 30;						}				else{			$imgH		= 85;					$imgW		= 58;					$logosize	= 25;		}		$pos_x	=	$delta	= 	($div_x - $imgW)/2;		$pos_y	=  	$y		=	185-(($numRows-1)*20);		$c		=	$r		=  	$n = 0;				$x 		= 	$pos_x + $comp;						foreach($assets as $k => $value){						$n++;			$thiskey 	= array_keys((array)$value);					$station 	= $thiskey[0];			$thiscover  = str_replace(' ', '', $value->$thiskey[0]->cover);			$trailer	= $value->$thiskey[0]->trailer;			$showType	= $value->$thiskey[0]->showType;						$tmpfile 	= (string)$n.'.jpg';						$ccopy 		= copy($thiscover, getcwd().'/ppt/assets/'.$tmpfile);			if($showType == 'mv'){				$showType = 'Trailer';			}			else{				$showType = 'Clip';							}         	$netlogo 	= $currentSlide->	         				createDrawingShape()							->setPath(getcwd().'/ppt/assets/'.$tmpfile)							->setHeight($imgH)							->setWidth($imgW)							->setOffsetX($x)							->setOffsetY($y);			$logo	= '';            foreach($arrNetworks as $network){                if(trim($network['networkId'])==$station){					$imgPath 	= str_replace('/downloads','',getcwd());					$logo 	 	= $imgPath.'/i/networklogos/'.$network['filename'];                }            } 			if($trailer == 'undefined' && $trailer == ''){				if($numRows == 4){					$x_logo = $x;				}				elseif($numRows == 3){					$x_logo = $x +25;									}				elseif($numRows == 2){					$x_logo = $x +40;									}				else{					$x_logo = $x + 100;									}													}			else{				$x_logo = $x;							}			if (file_exists($logo)) {				$netlogo = $currentSlide->					createDrawingShape()					->setPath($logo)					->setHeight($logosize)					->setWidth($logosize)					->setOffsetX($x_logo)					->setOffsetY($y + $imgH+1);			} 			else{				$shape = $currentSlide->createRichTextShape();				$shape->setHeight(30);				$shape->setOffsetX($x_logo);								$shape->setOffsetY($y + $imgH+1);				$shape->getActiveParagraph()->getAlignment()->setHorizontal( PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER );									$shape->setWidth(90);				$mvtrailer = $shape->createTextRun('');									$mvtrailer->getFont()->setName('Verdana')->setBold(true)->setSize(10)->setColor( new PHPPowerPoint_Style_Color( '33333333' ) );				}			if($trailer != 'undefined' && $trailer != ''){ 				$shape = $currentSlide->createRichTextShape();				$shape->setHeight(30);				$shape->setOffsetX($x + $logosize+ 1);				if($numRows == 4){				$shape->setOffsetY($y + $imgH +1);				$shape->getActiveParagraph()->getAlignment()->setHorizontal( PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER );				$shape->setWidth(70);				$mvtrailer = $shape->createTextRun($showType);				$mvtrailer->getFont()->setName('Verdana')->setBold(true)->setSize(9)->setColor( new PHPPowerPoint_Style_Color( '33333333' ) );									}				elseif($numRows == 3){				$shape->setOffsetY($y + $imgH +1);				$shape->getActiveParagraph()->getAlignment()->setHorizontal( PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER );									$shape->setWidth(80);				$mvtrailer = $shape->createTextRun($showType);									$mvtrailer->getFont()->setName('Verdana')->setBold(true)->setSize(10)->setColor( new PHPPowerPoint_Style_Color( '33333333' ) );									}				elseif ($numRows == 2){				$shape->setOffsetY($y + $imgH +3);				$shape->getActiveParagraph()->getAlignment()->setHorizontal( PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER );									$shape->setWidth(90);				$mvtrailer = $shape->createTextRun($showType);									$mvtrailer->getFont()->setName('Verdana')->setBold(true)->setSize(12)->setColor( new PHPPowerPoint_Style_Color( '33333333' ) );									}				else{				$shape->setOffsetY($y + $imgH +10);				$shape->getActiveParagraph()->getAlignment()->setHorizontal( PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER );									$shape->setWidth(100);				$mvtrailer = $shape->createTextRun($showType);									$mvtrailer->getFont()->setName('Verdana')->setBold(true)->setSize(14)->setColor( new PHPPowerPoint_Style_Color( '33333333' ) );									}				$mvtrailer->getHyperlink()->setUrl('https://plus.showseeker.com/goplus/player/trailer.php?url='.urlencode($trailer))->setTooltip('Watch Trailer'); 			}						//increments						if($c < $numCols-1){				$x = ($c+1) * $div_x + $delta + $comp;				$c++;			}			else{				$x = 	$pos_x + $comp;				$y =	$y + $imgH + $verticalspace;									$c = 	0;			}		}	return $currentSlide;}function convertImage($originalImage, $outputImage, $quality){    // jpg, png, gif or bmp?    $exploded = explode('.',$originalImage);    $ext = $exploded[count($exploded) - 1];     if (preg_match('/jpg|jpeg/i',$ext))        $imageTmp=imagecreatefromjpeg($originalImage);    else if (preg_match('/png/i',$ext))        $imageTmp=imagecreatefrompng($originalImage);    else if (preg_match('/gif/i',$ext))        $imageTmp=imagecreatefromgif($originalImage);    else if (preg_match('/bmp/i',$ext))        $imageTmp=imagecreatefrombmp($originalImage);    else        return 0;    // quality is a value from 0 (worst) to 100 (best)    imagejpeg($imageTmp, $outputImage, $quality);    imagedestroy($imageTmp);    return 1;}?>