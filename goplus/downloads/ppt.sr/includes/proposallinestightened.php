<?phpfunction createProposalLine(&$row, $line, $arrNetworks, &$currentSlide, $y, $rowheight, $logosize, $logo_x, $logo_y,$includeDesc){try{	$row->setHeight($rowheight);	//network          	$cell = $row->nextCell();	//$cell->createTextRun($line['callsign'])->getFont();			$thislogo = findStationLogo($arrNetworks, trim($line['stationnum']));	//if (file_exists($thislogo)) {		$netlogo = $currentSlide->createDrawingShape()	    ->setPath($thislogo)	    ->setHeight($logosize)	    ->setWidth($logosize)	    ->setOffsetX($logo_x)	    ->setOffsetY($y+$logo_y);	//}    	//title	$cell = $row->nextCell();			if($line['linetype'] == 'Fixed'){				$cell->createTextRun($line['title'].' ')->getFont()->setBold(true);	}	else{		$thesetitles = explode(',',$line['title']);		if(count($thesetitles) <= 3){		$cell->createTextRun($line['title'].' ')->getFont()->setBold(true);			}		else{		$cell->createTextRun($thesetitles[0].', '.$thesetitles[1].', '.$thesetitles[2].', more ...')->getFont()->setBold(true);					}	}			$cell->createTextRun($line['epititle'].' ')->getFont()->setColor( new PHPPowerPoint_Style_Color( '000069D2' ) )->setBold(true)->setItalic(true);	$cell->createTextRun($line['live'].' ')->getFont()->setColor( new PHPPowerPoint_Style_Color( '008A2BE2' ) )->setBold(true)->setItalic(true);	if($includeDesc == 'Y' && isset($line['desc60'])){	$cell->createTextRun($line['desc60'].' ')->getFont();	}			//daypart	$dp = $line['dayFormat'].' '.str_replace('M','',str_replace(':00','',date ('g:iA',strtotime($line['starttime'])))).'-'.str_replace('M','',str_replace(':00','',date ('g:iA',strtotime($line['endtime']))));	$cell = $row->nextCell();		if(substr($dp, -9) == '6A-11:59P' && $line['projected'] == 1){	$cell->createTextRun($line['dayFormat'])->getFont()->setBold(true);	$cell->createTextRun(' Times TBD')->getFont()->setBold(true)->setItalic(true);		}	else{	$cell->createTextRun($dp )->getFont()->setBold(true);		}		if($line['isnew'] == 'New' && $line['premiere'] == ''){	$cell->createBreak();	$cell->createTextRun($line['isnew'].' ')->getFont()->setColor( new PHPPowerPoint_Style_Color( '00458B00' ) )->setBold(true)->setItalic(true);	}	else{		if($line['premiere'] != ''){		$cell->createBreak();		$cell->createTextRun($line['premiere'].' ')->getFont()->setColor( new PHPPowerPoint_Style_Color( '00FF0000' ) )->setBold(true)->setItalic(true);		}	}		$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_LEFT);			//dates	$cell = $row->nextCell();	if($line['linetype'] == 'Fixed'){		$cell->createTextRun(date('n/j/y',strtotime($line['startdate'])))->getFont();	}	else{		//$cell->createTextRun(date ('n/j/y',strtotime($line['startdate'])).' - '.date ('n/j/y', strtotime($line['enddate']) ))->getFont();			$cell->createTextRun(date ('n-j-y',strtotime($line['startdate'])))->getFont();			$cell->createBreak();			$cell->createTextRun('to')->getFont()->setSize(9);						$cell->createBreak();			$cell->createTextRun(date ('n-j-y',strtotime($line['enddate'])))->getFont();	}	$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER);			//weeks	$cell = $row->nextCell();	$cell->createTextRun($line['weeks'])->getFont();	$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_CENTER);				//Rate	$cell = $row->nextCell();	$cell->createTextRun(money_format('$%i',$line['rate']))->getFont();		$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_RIGHT);				//Spots	$cell = $row->nextCell();	$cell->createTextRun($line['spots'])->getFont();		$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_RIGHT);		//Total	$cell = $row->nextCell();	$cell->createTextRun('$'. number_format($line['spots']*$line['rate'],2,'.',','))->getFont();		$cell->getActiveParagraph()->getAlignment()->setHorizontal(PHPPowerPoint_Style_Alignment::HORIZONTAL_RIGHT);			}	catch (Exception $e) {	}	return $row;}?>